Some weights of EsmForSequenceClassification were not initialized from the model checkpoint at facebook/esm2_t6_8M_UR50D and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|███████████████████████████████████████████████████████████████████████████████████████| 436/436 [00:00<00:00, 22417.06 examples/s]
Map: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:00<00:00, 11412.10 examples/s]
[2024-10-15 17:23:45,914] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m NVIDIA Inference is only supported on Ampere and newer architectures
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.1), only 1.0.0 is known to be compatible
[34m[1mwandb[0m: [33mWARNING[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
  0%|                                                                                                                | 0/700 [00:00<?, ?it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|██                                                                                                     | 14/700 [00:06<00:52, 13.18it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.5220577120780945, 'eval_accuracy': 0.734375, 'eval_recall': 0.7166666666666667, 'eval_runtime': 5.1245, 'eval_samples_per_second': 12.489, 'eval_steps_per_second': 0.39, 'epoch': 1.0}
  4%|████                                                                                                   | 28/700 [00:12<02:24,  4.65it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.37998008728027344, 'eval_accuracy': 0.890625, 'eval_recall': 0.8872549019607843, 'eval_runtime': 4.2349, 'eval_samples_per_second': 15.113, 'eval_steps_per_second': 0.472, 'epoch': 2.0}
  6%|██████▏                                                                                                | 42/700 [00:17<02:15,  4.86it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.3759722411632538, 'eval_accuracy': 0.859375, 'eval_recall': 0.8637254901960785, 'eval_runtime': 4.7044, 'eval_samples_per_second': 13.604, 'eval_steps_per_second': 0.425, 'epoch': 3.0}
  8%|████████▏                                                                                              | 56/700 [00:24<02:21,  4.54it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.3699997663497925, 'eval_accuracy': 0.84375, 'eval_recall': 0.8392156862745098, 'eval_runtime': 5.4186, 'eval_samples_per_second': 11.811, 'eval_steps_per_second': 0.369, 'epoch': 4.0}
 10%|██████████▎                                                                                            | 70/700 [00:30<02:42,  3.87it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.4564613401889801, 'eval_accuracy': 0.796875, 'eval_recall': 0.8049019607843138, 'eval_runtime': 5.1253, 'eval_samples_per_second': 12.487, 'eval_steps_per_second': 0.39, 'epoch': 5.0}
 12%|████████████▎                                                                                          | 84/700 [00:35<02:47,  3.68it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.4257984161376953, 'eval_accuracy': 0.8125, 'eval_recall': 0.8019607843137255, 'eval_runtime': 3.9862, 'eval_samples_per_second': 16.055, 'eval_steps_per_second': 0.502, 'epoch': 6.0}
 14%|██████████████▍                                                                                        | 98/700 [00:42<04:21,  2.30it/s]
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'eval_loss': 0.4545597434043884, 'eval_accuracy': 0.78125, 'eval_recall': 0.7921568627450981, 'eval_runtime': 5.4049, 'eval_samples_per_second': 11.841, 'eval_steps_per_second': 0.37, 'epoch': 7.0}
{'train_runtime': 43.1277, 'train_samples_per_second': 505.476, 'train_steps_per_second': 16.231, 'train_loss': 0.45958063553790657, 'epoch': 7.0}
  warnings.warn('Was asked to gather along dimension 0, but all '
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.18s/it]
Model Saved!
