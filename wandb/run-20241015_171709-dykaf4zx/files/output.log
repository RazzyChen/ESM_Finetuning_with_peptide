Some weights of EsmForSequenceClassification were not initialized from the model checkpoint at facebook/esm2_t6_8M_UR50D and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 436/436 [00:00<00:00, 22104.90 examples/s]
Map: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:00<00:00, 11417.44 examples/s]
[2024-10-15 17:17:12,386] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m NVIDIA Inference is only supported on Ampere and newer architectures
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.1), only 1.0.0 is known to be compatible
[34m[1mwandb[0m: [33mWARNING[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
  0%|                                                                                                                                 | 0/350 [00:00<?, ?it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|██▍                                                                                                                      | 7/350 [00:08<00:45,  7.61it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6468835473060608, 'eval_accuracy': 0.65625, 'eval_recall': 0.6764705882352942, 'eval_runtime': 7.4782, 'eval_samples_per_second': 8.558, 'eval_steps_per_second': 0.134, 'epoch': 1.0}
  4%|████▊                                                                                                                   | 14/350 [00:15<03:32,  1.58it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.5673666596412659, 'eval_accuracy': 0.65625, 'eval_recall': 0.6333333333333333, 'eval_runtime': 5.3689, 'eval_samples_per_second': 11.921, 'eval_steps_per_second': 0.186, 'epoch': 2.0}
  6%|███████▏                                                                                                                | 21/350 [00:19<04:03,  1.35it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.4937322437763214, 'eval_accuracy': 0.734375, 'eval_recall': 0.7166666666666667, 'eval_runtime': 3.5159, 'eval_samples_per_second': 18.203, 'eval_steps_per_second': 0.284, 'epoch': 3.0}
  8%|█████████▌                                                                                                              | 28/350 [00:24<02:44,  1.96it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.4081437587738037, 'eval_accuracy': 0.859375, 'eval_recall': 0.8637254901960785, 'eval_runtime': 3.8079, 'eval_samples_per_second': 16.807, 'eval_steps_per_second': 0.263, 'epoch': 4.0}
 10%|████████████                                                                                                            | 35/350 [00:30<02:33,  2.06it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.3824601173400879, 'eval_accuracy': 0.84375, 'eval_recall': 0.8490196078431372, 'eval_runtime': 5.1, 'eval_samples_per_second': 12.549, 'eval_steps_per_second': 0.196, 'epoch': 5.0}
 12%|██████████████▍                                                                                                         | 42/350 [00:34<02:51,  1.80it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.38457587361335754, 'eval_accuracy': 0.859375, 'eval_recall': 0.8637254901960785, 'eval_runtime': 3.5581, 'eval_samples_per_second': 17.987, 'eval_steps_per_second': 0.281, 'epoch': 6.0}
 14%|████████████████▊                                                                                                       | 49/350 [00:39<02:50,  1.77it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.37443020939826965, 'eval_accuracy': 0.875, 'eval_recall': 0.8705882352941177, 'eval_runtime': 4.4079, 'eval_samples_per_second': 14.519, 'eval_steps_per_second': 0.227, 'epoch': 7.0}
 16%|███████████████████▏                                                                                                    | 56/350 [00:45<02:27,  1.99it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.3351297080516815, 'eval_accuracy': 0.875, 'eval_recall': 0.8686274509803922, 'eval_runtime': 5.1772, 'eval_samples_per_second': 12.362, 'eval_steps_per_second': 0.193, 'epoch': 8.0}
 18%|█████████████████████▌                                                                                                  | 63/350 [00:51<03:08,  1.52it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.39725443720817566, 'eval_accuracy': 0.90625, 'eval_recall': 0.9058823529411765, 'eval_runtime': 4.7954, 'eval_samples_per_second': 13.346, 'eval_steps_per_second': 0.209, 'epoch': 9.0}
 20%|████████████████████████                                                                                                | 70/350 [00:56<02:36,  1.79it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.5833406448364258, 'eval_accuracy': 0.6875, 'eval_recall': 0.7039215686274509, 'eval_runtime': 3.8517, 'eval_samples_per_second': 16.616, 'eval_steps_per_second': 0.26, 'epoch': 10.0}
 22%|██████████████████████████▍                                                                                             | 77/350 [01:01<02:40,  1.70it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.3088168799877167, 'eval_accuracy': 0.90625, 'eval_recall': 0.907843137254902, 'eval_runtime': 3.8397, 'eval_samples_per_second': 16.668, 'eval_steps_per_second': 0.26, 'epoch': 11.0}
 24%|████████████████████████████▊                                                                                           | 84/350 [01:05<02:08,  2.08it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.3335142135620117, 'eval_accuracy': 0.859375, 'eval_recall': 0.853921568627451, 'eval_runtime': 3.8637, 'eval_samples_per_second': 16.565, 'eval_steps_per_second': 0.259, 'epoch': 12.0}
 26%|███████████████████████████████▏                                                                                        | 91/350 [01:12<02:03,  2.10it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.5015222430229187, 'eval_accuracy': 0.8125, 'eval_recall': 0.803921568627451, 'eval_runtime': 5.9711, 'eval_samples_per_second': 10.718, 'eval_steps_per_second': 0.167, 'epoch': 13.0}
 28%|█████████████████████████████████▌                                                                                      | 98/350 [01:20<03:27,  1.22it/s]
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'eval_loss': 0.3513232469558716, 'eval_accuracy': 0.890625, 'eval_recall': 0.8852941176470588, 'eval_runtime': 6.8882, 'eval_samples_per_second': 9.291, 'eval_steps_per_second': 0.145, 'epoch': 14.0}
{'train_runtime': 81.1151, 'train_samples_per_second': 268.754, 'train_steps_per_second': 4.315, 'train_loss': 0.44452180667799346, 'epoch': 14.0}
  warnings.warn('Was asked to gather along dimension 0, but all '
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:03<00:00,  3.12s/it]
Model Saved!
