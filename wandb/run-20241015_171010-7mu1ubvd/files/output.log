Some weights of EsmForSequenceClassification were not initialized from the model checkpoint at facebook/esm2_t6_8M_UR50D and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 436/436 [00:00<00:00, 22378.93 examples/s]
Map: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:00<00:00, 11452.51 examples/s]
[2024-10-15 17:10:13,061] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m NVIDIA Inference is only supported on Ampere and newer architectures
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.1), only 1.0.0 is known to be compatible
[34m[1mwandb[0m: [33mWARNING[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
  0%|                                                                                                                                 | 0/350 [00:00<?, ?it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|██▍                                                                                                                      | 7/350 [00:08<00:45,  7.55it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6932054758071899, 'eval_accuracy': 0.46875, 'eval_recall': 0.5, 'eval_runtime': 7.086, 'eval_samples_per_second': 9.032, 'eval_steps_per_second': 0.141, 'epoch': 1.0}
  4%|████▊                                                                                                                   | 14/350 [00:12<03:48,  1.47it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.680082380771637, 'eval_accuracy': 0.53125, 'eval_recall': 0.5588235294117647, 'eval_runtime': 3.4509, 'eval_samples_per_second': 18.546, 'eval_steps_per_second': 0.29, 'epoch': 2.0}
  6%|███████▏                                                                                                                | 21/350 [00:21<03:21,  1.63it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6543074250221252, 'eval_accuracy': 0.765625, 'eval_recall': 0.7715686274509804, 'eval_runtime': 8.1742, 'eval_samples_per_second': 7.83, 'eval_steps_per_second': 0.122, 'epoch': 3.0}
  8%|█████████▌                                                                                                              | 28/350 [00:27<03:53,  1.38it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6239163875579834, 'eval_accuracy': 0.828125, 'eval_recall': 0.8186274509803921, 'eval_runtime': 4.617, 'eval_samples_per_second': 13.862, 'eval_steps_per_second': 0.217, 'epoch': 4.0}
 10%|████████████                                                                                                            | 35/350 [00:32<03:46,  1.39it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.5894795060157776, 'eval_accuracy': 0.84375, 'eval_recall': 0.8372549019607842, 'eval_runtime': 4.6981, 'eval_samples_per_second': 13.623, 'eval_steps_per_second': 0.213, 'epoch': 5.0}
 12%|██████████████▍                                                                                                         | 42/350 [00:39<02:57,  1.73it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.5434043407440186, 'eval_accuracy': 0.8125, 'eval_recall': 0.807843137254902, 'eval_runtime': 5.6331, 'eval_samples_per_second': 11.361, 'eval_steps_per_second': 0.178, 'epoch': 6.0}
 14%|████████████████▊                                                                                                       | 49/350 [00:45<03:37,  1.38it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.505308210849762, 'eval_accuracy': 0.828125, 'eval_recall': 0.8225490196078431, 'eval_runtime': 4.684, 'eval_samples_per_second': 13.664, 'eval_steps_per_second': 0.213, 'epoch': 7.0}
 16%|███████████████████▏                                                                                                    | 56/350 [00:49<02:49,  1.73it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.4723665714263916, 'eval_accuracy': 0.890625, 'eval_recall': 0.8911764705882352, 'eval_runtime': 3.7764, 'eval_samples_per_second': 16.947, 'eval_steps_per_second': 0.265, 'epoch': 8.0}
 18%|█████████████████████▌                                                                                                  | 63/350 [00:54<02:49,  1.69it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.45418527722358704, 'eval_accuracy': 0.84375, 'eval_recall': 0.8490196078431372, 'eval_runtime': 4.1067, 'eval_samples_per_second': 15.584, 'eval_steps_per_second': 0.244, 'epoch': 9.0}
 20%|████████████████████████                                                                                                | 70/350 [00:59<02:15,  2.06it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.4416826069355011, 'eval_accuracy': 0.859375, 'eval_recall': 0.8558823529411765, 'eval_runtime': 3.8306, 'eval_samples_per_second': 16.707, 'eval_steps_per_second': 0.261, 'epoch': 10.0}
 22%|██████████████████████████▍                                                                                             | 77/350 [01:05<02:10,  2.10it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.42048460245132446, 'eval_accuracy': 0.890625, 'eval_recall': 0.8931372549019607, 'eval_runtime': 5.0265, 'eval_samples_per_second': 12.733, 'eval_steps_per_second': 0.199, 'epoch': 11.0}
 24%|████████████████████████████▊                                                                                           | 84/350 [01:10<02:50,  1.56it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.41942840814590454, 'eval_accuracy': 0.859375, 'eval_recall': 0.853921568627451, 'eval_runtime': 3.7981, 'eval_samples_per_second': 16.85, 'eval_steps_per_second': 0.263, 'epoch': 12.0}
 26%|███████████████████████████████▏                                                                                        | 91/350 [01:15<03:34,  1.21it/s]
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'eval_loss': 0.39832693338394165, 'eval_accuracy': 0.84375, 'eval_recall': 0.8490196078431372, 'eval_runtime': 4.1403, 'eval_samples_per_second': 15.458, 'eval_steps_per_second': 0.242, 'epoch': 13.0}
{'train_runtime': 75.971, 'train_samples_per_second': 286.951, 'train_steps_per_second': 4.607, 'train_loss': 0.5802114717252962, 'epoch': 13.0}
  warnings.warn('Was asked to gather along dimension 0, but all '
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.21s/it]
Model Saved!
