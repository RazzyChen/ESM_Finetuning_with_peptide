Some weights of EsmForSequenceClassification were not initialized from the model checkpoint at facebook/esm2_t6_8M_UR50D and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 436/436 [00:00<00:00, 22426.96 examples/s]
Map: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:00<00:00, 11402.89 examples/s]
[2024-10-15 17:14:57,591] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m NVIDIA Inference is only supported on Ampere and newer architectures
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.1), only 1.0.0 is known to be compatible
[34m[1mwandb[0m: [33mWARNING[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
  0%|                                                                                                                                 | 0/350 [00:00<?, ?it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|██▍                                                                                                                      | 7/350 [00:07<01:04,  5.34it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6646955013275146, 'eval_accuracy': 0.71875, 'eval_recall': 0.7352941176470589, 'eval_runtime': 6.2277, 'eval_samples_per_second': 10.277, 'eval_steps_per_second': 0.161, 'epoch': 1.0}
  4%|████▊                                                                                                                   | 14/350 [00:13<02:41,  2.09it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.5830352306365967, 'eval_accuracy': 0.765625, 'eval_recall': 0.75, 'eval_runtime': 5.13, 'eval_samples_per_second': 12.476, 'eval_steps_per_second': 0.195, 'epoch': 2.0}
  6%|███████▏                                                                                                                | 21/350 [00:19<03:02,  1.80it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.4687356948852539, 'eval_accuracy': 0.765625, 'eval_recall': 0.7519607843137255, 'eval_runtime': 5.5562, 'eval_samples_per_second': 11.519, 'eval_steps_per_second': 0.18, 'epoch': 3.0}
  8%|█████████▌                                                                                                              | 28/350 [00:25<03:50,  1.40it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.5142724514007568, 'eval_accuracy': 0.71875, 'eval_recall': 0.7313725490196079, 'eval_runtime': 5.0893, 'eval_samples_per_second': 12.575, 'eval_steps_per_second': 0.196, 'epoch': 4.0}
 10%|████████████                                                                                                            | 35/350 [00:32<03:01,  1.73it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.43469861149787903, 'eval_accuracy': 0.8125, 'eval_recall': 0.8196078431372549, 'eval_runtime': 5.8161, 'eval_samples_per_second': 11.004, 'eval_steps_per_second': 0.172, 'epoch': 5.0}
 12%|██████████████▍                                                                                                         | 42/350 [00:39<03:45,  1.36it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.4502437114715576, 'eval_accuracy': 0.796875, 'eval_recall': 0.8049019607843138, 'eval_runtime': 6.3803, 'eval_samples_per_second': 10.031, 'eval_steps_per_second': 0.157, 'epoch': 6.0}
 14%|████████████████▊                                                                                                       | 49/350 [00:46<03:22,  1.49it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.39527857303619385, 'eval_accuracy': 0.859375, 'eval_recall': 0.8558823529411765, 'eval_runtime': 5.7638, 'eval_samples_per_second': 11.104, 'eval_steps_per_second': 0.173, 'epoch': 7.0}
 16%|███████████████████▏                                                                                                    | 56/350 [00:51<03:15,  1.51it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.42237260937690735, 'eval_accuracy': 0.8125, 'eval_recall': 0.8196078431372549, 'eval_runtime': 4.3646, 'eval_samples_per_second': 14.663, 'eval_steps_per_second': 0.229, 'epoch': 8.0}
 18%|█████████████████████▌                                                                                                  | 63/350 [00:58<03:13,  1.49it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.3487128019332886, 'eval_accuracy': 0.890625, 'eval_recall': 0.8931372549019607, 'eval_runtime': 5.8009, 'eval_samples_per_second': 11.033, 'eval_steps_per_second': 0.172, 'epoch': 9.0}
 20%|████████████████████████                                                                                                | 70/350 [01:04<02:52,  1.62it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.3910543620586395, 'eval_accuracy': 0.8125, 'eval_recall': 0.8196078431372549, 'eval_runtime': 4.6057, 'eval_samples_per_second': 13.896, 'eval_steps_per_second': 0.217, 'epoch': 10.0}
 22%|██████████████████████████▍                                                                                             | 77/350 [01:08<03:02,  1.50it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.5833472609519958, 'eval_accuracy': 0.703125, 'eval_recall': 0.7186274509803922, 'eval_runtime': 4.0773, 'eval_samples_per_second': 15.697, 'eval_steps_per_second': 0.245, 'epoch': 11.0}
 24%|████████████████████████████▊                                                                                           | 84/350 [01:14<02:19,  1.90it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.3114772140979767, 'eval_accuracy': 0.90625, 'eval_recall': 0.903921568627451, 'eval_runtime': 4.2584, 'eval_samples_per_second': 15.029, 'eval_steps_per_second': 0.235, 'epoch': 12.0}
 26%|███████████████████████████████▏                                                                                        | 91/350 [01:18<02:35,  1.66it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.34975817799568176, 'eval_accuracy': 0.90625, 'eval_recall': 0.9058823529411765, 'eval_runtime': 3.8758, 'eval_samples_per_second': 16.513, 'eval_steps_per_second': 0.258, 'epoch': 13.0}
 28%|█████████████████████████████████▌                                                                                      | 98/350 [01:25<02:03,  2.04it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.40279319882392883, 'eval_accuracy': 0.859375, 'eval_recall': 0.8519607843137255, 'eval_runtime': 5.661, 'eval_samples_per_second': 11.305, 'eval_steps_per_second': 0.177, 'epoch': 14.0}
 30%|███████████████████████████████████▋                                                                                   | 105/350 [01:31<02:47,  1.46it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.34021639823913574, 'eval_accuracy': 0.859375, 'eval_recall': 0.8558823529411765, 'eval_runtime': 5.5662, 'eval_samples_per_second': 11.498, 'eval_steps_per_second': 0.18, 'epoch': 15.0}
 32%|██████████████████████████████████████                                                                                 | 112/350 [01:36<02:25,  1.64it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.5719841122627258, 'eval_accuracy': 0.75, 'eval_recall': 0.7627450980392156, 'eval_runtime': 3.8376, 'eval_samples_per_second': 16.677, 'eval_steps_per_second': 0.261, 'epoch': 16.0}
 34%|████████████████████████████████████████▍                                                                              | 119/350 [01:43<03:20,  1.15it/s]
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'eval_loss': 0.37053802609443665, 'eval_accuracy': 0.859375, 'eval_recall': 0.8519607843137255, 'eval_runtime': 5.4433, 'eval_samples_per_second': 11.758, 'eval_steps_per_second': 0.184, 'epoch': 17.0}
{'train_runtime': 103.7755, 'train_samples_per_second': 210.069, 'train_steps_per_second': 3.373, 'train_loss': 0.4541872809914982, 'epoch': 17.0}
  warnings.warn('Was asked to gather along dimension 0, but all '
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:03<00:00,  3.34s/it]
Model Saved!
