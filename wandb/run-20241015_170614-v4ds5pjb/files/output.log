Some weights of EsmForSequenceClassification were not initialized from the model checkpoint at facebook/esm2_t6_8M_UR50D and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 436/436 [00:00<00:00, 13391.40 examples/s]
Map: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:00<00:00, 7547.95 examples/s]
[2024-10-15 17:06:16,638] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m NVIDIA Inference is only supported on Ampere and newer architectures
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.1), only 1.0.0 is known to be compatible
[34m[1mwandb[0m: [33mWARNING[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
  0%|                                                                                                                                 | 0/350 [00:00<?, ?it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|██▍                                                                                                                      | 7/350 [00:05<00:44,  7.66it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6853411197662354, 'eval_accuracy': 0.53125, 'eval_recall': 0.5, 'eval_runtime': 4.2303, 'eval_samples_per_second': 15.129, 'eval_steps_per_second': 0.236, 'epoch': 1.0}
  4%|████▊                                                                                                                   | 14/350 [00:10<02:31,  2.22it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6772956252098083, 'eval_accuracy': 0.625, 'eval_recall': 0.6470588235294118, 'eval_runtime': 4.002, 'eval_samples_per_second': 15.992, 'eval_steps_per_second': 0.25, 'epoch': 2.0}
  6%|███████▏                                                                                                                | 21/350 [00:15<03:00,  1.83it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6589726805686951, 'eval_accuracy': 0.640625, 'eval_recall': 0.6617647058823529, 'eval_runtime': 4.565, 'eval_samples_per_second': 14.02, 'eval_steps_per_second': 0.219, 'epoch': 3.0}
  8%|█████████▌                                                                                                              | 28/350 [00:22<02:38,  2.03it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6268842816352844, 'eval_accuracy': 0.8125, 'eval_recall': 0.8058823529411765, 'eval_runtime': 6.0436, 'eval_samples_per_second': 10.59, 'eval_steps_per_second': 0.165, 'epoch': 4.0}
 10%|████████████                                                                                                            | 35/350 [00:29<03:12,  1.64it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.5918211340904236, 'eval_accuracy': 0.796875, 'eval_recall': 0.7852941176470588, 'eval_runtime': 5.4089, 'eval_samples_per_second': 11.832, 'eval_steps_per_second': 0.185, 'epoch': 5.0}
 12%|██████████████▍                                                                                                         | 42/350 [00:35<03:44,  1.37it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.5452795028686523, 'eval_accuracy': 0.8125, 'eval_recall': 0.807843137254902, 'eval_runtime': 5.199, 'eval_samples_per_second': 12.31, 'eval_steps_per_second': 0.192, 'epoch': 6.0}
 14%|████████████████▊                                                                                                       | 49/350 [00:40<03:01,  1.66it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.5072965025901794, 'eval_accuracy': 0.828125, 'eval_recall': 0.8225490196078431, 'eval_runtime': 4.8003, 'eval_samples_per_second': 13.333, 'eval_steps_per_second': 0.208, 'epoch': 7.0}
 16%|███████████████████▏                                                                                                    | 56/350 [00:47<03:18,  1.48it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.4739542603492737, 'eval_accuracy': 0.859375, 'eval_recall': 0.8558823529411765, 'eval_runtime': 5.2894, 'eval_samples_per_second': 12.1, 'eval_steps_per_second': 0.189, 'epoch': 8.0}
 18%|█████████████████████▌                                                                                                  | 63/350 [00:52<02:50,  1.69it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.46367141604423523, 'eval_accuracy': 0.828125, 'eval_recall': 0.8343137254901961, 'eval_runtime': 4.1692, 'eval_samples_per_second': 15.351, 'eval_steps_per_second': 0.24, 'epoch': 9.0}
 20%|████████████████████████                                                                                                | 70/350 [00:56<02:56,  1.59it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.45595696568489075, 'eval_accuracy': 0.828125, 'eval_recall': 0.8186274509803921, 'eval_runtime': 3.5092, 'eval_samples_per_second': 18.238, 'eval_steps_per_second': 0.285, 'epoch': 10.0}
 22%|██████████████████████████▍                                                                                             | 77/350 [01:02<02:10,  2.08it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.4526953101158142, 'eval_accuracy': 0.796875, 'eval_recall': 0.8049019607843138, 'eval_runtime': 4.6839, 'eval_samples_per_second': 13.664, 'eval_steps_per_second': 0.213, 'epoch': 11.0}
 24%|████████████████████████████▊                                                                                           | 84/350 [01:09<02:18,  1.92it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.43559715151786804, 'eval_accuracy': 0.84375, 'eval_recall': 0.8372549019607842, 'eval_runtime': 6.2894, 'eval_samples_per_second': 10.176, 'eval_steps_per_second': 0.159, 'epoch': 12.0}
 26%|███████████████████████████████▏                                                                                        | 91/350 [01:15<03:13,  1.34it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.40413495898246765, 'eval_accuracy': 0.875, 'eval_recall': 0.8784313725490196, 'eval_runtime': 5.1112, 'eval_samples_per_second': 12.522, 'eval_steps_per_second': 0.196, 'epoch': 13.0}
 28%|█████████████████████████████████▌                                                                                      | 98/350 [01:21<02:31,  1.66it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.4005727171897888, 'eval_accuracy': 0.921875, 'eval_recall': 0.9205882352941177, 'eval_runtime': 5.7244, 'eval_samples_per_second': 11.18, 'eval_steps_per_second': 0.175, 'epoch': 14.0}
 30%|███████████████████████████████████▋                                                                                   | 105/350 [01:27<03:00,  1.36it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.39469262957572937, 'eval_accuracy': 0.859375, 'eval_recall': 0.8637254901960785, 'eval_runtime': 5.3233, 'eval_samples_per_second': 12.023, 'eval_steps_per_second': 0.188, 'epoch': 15.0}
 32%|██████████████████████████████████████                                                                                 | 112/350 [01:32<02:25,  1.64it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.38701823353767395, 'eval_accuracy': 0.921875, 'eval_recall': 0.9225490196078432, 'eval_runtime': 4.3899, 'eval_samples_per_second': 14.579, 'eval_steps_per_second': 0.228, 'epoch': 16.0}
 34%|████████████████████████████████████████▍                                                                              | 119/350 [01:37<02:29,  1.55it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.3806188106536865, 'eval_accuracy': 0.921875, 'eval_recall': 0.9225490196078432, 'eval_runtime': 3.5746, 'eval_samples_per_second': 17.904, 'eval_steps_per_second': 0.28, 'epoch': 17.0}
 36%|██████████████████████████████████████████▊                                                                            | 126/350 [01:41<01:48,  2.06it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.36910387873649597, 'eval_accuracy': 0.921875, 'eval_recall': 0.9225490196078432, 'eval_runtime': 3.7191, 'eval_samples_per_second': 17.209, 'eval_steps_per_second': 0.269, 'epoch': 18.0}
 38%|█████████████████████████████████████████████▏                                                                         | 133/350 [01:47<02:56,  1.23it/s]
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'eval_loss': 0.3620882034301758, 'eval_accuracy': 0.921875, 'eval_recall': 0.9225490196078432, 'eval_runtime': 5.1588, 'eval_samples_per_second': 12.406, 'eval_steps_per_second': 0.194, 'epoch': 19.0}
{'train_runtime': 108.5636, 'train_samples_per_second': 200.804, 'train_steps_per_second': 3.224, 'train_loss': 0.5303395780405604, 'epoch': 19.0}
  warnings.warn('Was asked to gather along dimension 0, but all '
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:04<00:00,  4.58s/it]
Model Saved!
