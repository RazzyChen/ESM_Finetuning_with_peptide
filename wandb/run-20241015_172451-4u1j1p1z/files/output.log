Some weights of EsmForSequenceClassification were not initialized from the model checkpoint at facebook/esm2_t6_8M_UR50D and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|███████████████████████████████████████████████████████████████████████████████████████| 436/436 [00:00<00:00, 22699.21 examples/s]
Map: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:00<00:00, 11848.32 examples/s]
[2024-10-15 17:24:53,746] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m NVIDIA Inference is only supported on Ampere and newer architectures
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.1), only 1.0.0 is known to be compatible
[34m[1mwandb[0m: [33mWARNING[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
  0%|                                                                                                                | 0/700 [00:00<?, ?it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|██                                                                                                     | 14/700 [00:08<00:50, 13.52it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.5087924003601074, 'eval_accuracy': 0.78125, 'eval_recall': 0.7686274509803921, 'eval_runtime': 7.0456, 'eval_samples_per_second': 9.084, 'eval_steps_per_second': 0.284, 'epoch': 1.0}
  4%|████                                                                                                   | 28/700 [00:14<03:10,  3.54it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.4341617226600647, 'eval_accuracy': 0.828125, 'eval_recall': 0.8343137254901961, 'eval_runtime': 5.2026, 'eval_samples_per_second': 12.302, 'eval_steps_per_second': 0.384, 'epoch': 2.0}
  6%|██████▏                                                                                                | 42/700 [00:19<02:42,  4.06it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.4112221896648407, 'eval_accuracy': 0.84375, 'eval_recall': 0.8392156862745098, 'eval_runtime': 3.6795, 'eval_samples_per_second': 17.394, 'eval_steps_per_second': 0.544, 'epoch': 3.0}
  8%|████████▏                                                                                              | 56/700 [00:25<02:09,  4.96it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.4022696614265442, 'eval_accuracy': 0.796875, 'eval_recall': 0.8049019607843138, 'eval_runtime': 5.0482, 'eval_samples_per_second': 12.678, 'eval_steps_per_second': 0.396, 'epoch': 4.0}
 10%|██████████▎                                                                                            | 70/700 [00:30<02:33,  4.11it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.6104753017425537, 'eval_accuracy': 0.703125, 'eval_recall': 0.6852941176470588, 'eval_runtime': 3.7238, 'eval_samples_per_second': 17.187, 'eval_steps_per_second': 0.537, 'epoch': 5.0}
 12%|████████████▎                                                                                          | 84/700 [00:37<02:12,  4.66it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.3275279104709625, 'eval_accuracy': 0.90625, 'eval_recall': 0.907843137254902, 'eval_runtime': 5.4829, 'eval_samples_per_second': 11.673, 'eval_steps_per_second': 0.365, 'epoch': 6.0}
 14%|██████████████▍                                                                                        | 98/700 [00:42<02:30,  3.99it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.3748675584793091, 'eval_accuracy': 0.921875, 'eval_recall': 0.9225490196078432, 'eval_runtime': 4.4665, 'eval_samples_per_second': 14.329, 'eval_steps_per_second': 0.448, 'epoch': 7.0}
 16%|████████████████▎                                                                                     | 112/700 [00:48<02:20,  4.19it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.48240986466407776, 'eval_accuracy': 0.796875, 'eval_recall': 0.7931372549019607, 'eval_runtime': 5.132, 'eval_samples_per_second': 12.471, 'eval_steps_per_second': 0.39, 'epoch': 8.0}
 18%|██████████████████▎                                                                                   | 126/700 [00:53<02:26,  3.91it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.3201051652431488, 'eval_accuracy': 0.90625, 'eval_recall': 0.907843137254902, 'eval_runtime': 3.8271, 'eval_samples_per_second': 16.723, 'eval_steps_per_second': 0.523, 'epoch': 9.0}
 20%|████████████████████▍                                                                                 | 140/700 [01:01<01:55,  4.84it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.3482007086277008, 'eval_accuracy': 0.890625, 'eval_recall': 0.8931372549019607, 'eval_runtime': 6.6474, 'eval_samples_per_second': 9.628, 'eval_steps_per_second': 0.301, 'epoch': 10.0}
 22%|██████████████████████▍                                                                               | 154/700 [01:06<02:37,  3.46it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.4303101897239685, 'eval_accuracy': 0.84375, 'eval_recall': 0.8352941176470587, 'eval_runtime': 4.1924, 'eval_samples_per_second': 15.266, 'eval_steps_per_second': 0.477, 'epoch': 11.0}
 24%|████████████████████████▍                                                                             | 168/700 [01:12<03:49,  2.32it/s]
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'eval_loss': 0.3514179289340973, 'eval_accuracy': 0.875, 'eval_recall': 0.8705882352941177, 'eval_runtime': 4.5456, 'eval_samples_per_second': 14.08, 'eval_steps_per_second': 0.44, 'epoch': 12.0}
{'train_runtime': 73.1219, 'train_samples_per_second': 298.132, 'train_steps_per_second': 9.573, 'train_loss': 0.428811890738351, 'epoch': 12.0}
  warnings.warn('Was asked to gather along dimension 0, but all '
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.84s/it]
Model Saved!
