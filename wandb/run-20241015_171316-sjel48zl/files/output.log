Some weights of EsmForSequenceClassification were not initialized from the model checkpoint at facebook/esm2_t6_8M_UR50D and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 436/436 [00:00<00:00, 22591.25 examples/s]
Map: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:00<00:00, 11798.84 examples/s]
[2024-10-15 17:13:18,179] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m NVIDIA Inference is only supported on Ampere and newer architectures
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.1), only 1.0.0 is known to be compatible
[34m[1mwandb[0m: [33mWARNING[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
  0%|                                                                                                                                 | 0/350 [00:00<?, ?it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|██▍                                                                                                                      | 7/350 [00:06<00:47,  7.24it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6899794936180115, 'eval_accuracy': 0.53125, 'eval_recall': 0.5, 'eval_runtime': 5.2285, 'eval_samples_per_second': 12.241, 'eval_steps_per_second': 0.191, 'epoch': 1.0}
  4%|████▊                                                                                                                   | 14/350 [00:11<03:15,  1.72it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6880579590797424, 'eval_accuracy': 0.71875, 'eval_recall': 0.7019607843137254, 'eval_runtime': 4.2167, 'eval_samples_per_second': 15.178, 'eval_steps_per_second': 0.237, 'epoch': 2.0}
  6%|███████▏                                                                                                                | 21/350 [00:18<02:42,  2.02it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6851578950881958, 'eval_accuracy': 0.5625, 'eval_recall': 0.5882352941176471, 'eval_runtime': 6.1763, 'eval_samples_per_second': 10.362, 'eval_steps_per_second': 0.162, 'epoch': 3.0}
  8%|█████████▌                                                                                                              | 28/350 [00:26<03:55,  1.37it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6797995567321777, 'eval_accuracy': 0.640625, 'eval_recall': 0.6617647058823529, 'eval_runtime': 7.1801, 'eval_samples_per_second': 8.914, 'eval_steps_per_second': 0.139, 'epoch': 4.0}
 10%|████████████                                                                                                            | 35/350 [00:32<03:45,  1.40it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6723718643188477, 'eval_accuracy': 0.71875, 'eval_recall': 0.7352941176470589, 'eval_runtime': 5.0835, 'eval_samples_per_second': 12.59, 'eval_steps_per_second': 0.197, 'epoch': 5.0}
 12%|██████████████▍                                                                                                         | 42/350 [00:37<03:49,  1.34it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6611666083335876, 'eval_accuracy': 0.828125, 'eval_recall': 0.8225490196078431, 'eval_runtime': 3.4612, 'eval_samples_per_second': 18.491, 'eval_steps_per_second': 0.289, 'epoch': 6.0}
 14%|████████████████▊                                                                                                       | 49/350 [00:41<02:36,  1.92it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6519589424133301, 'eval_accuracy': 0.78125, 'eval_recall': 0.7803921568627451, 'eval_runtime': 3.5588, 'eval_samples_per_second': 17.984, 'eval_steps_per_second': 0.281, 'epoch': 7.0}
 16%|███████████████████▏                                                                                                    | 56/350 [00:46<02:42,  1.81it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6402344107627869, 'eval_accuracy': 0.828125, 'eval_recall': 0.8186274509803921, 'eval_runtime': 3.8232, 'eval_samples_per_second': 16.74, 'eval_steps_per_second': 0.262, 'epoch': 8.0}
 18%|█████████████████████▌                                                                                                  | 63/350 [00:51<02:14,  2.13it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6310873627662659, 'eval_accuracy': 0.78125, 'eval_recall': 0.7784313725490195, 'eval_runtime': 4.0866, 'eval_samples_per_second': 15.661, 'eval_steps_per_second': 0.245, 'epoch': 9.0}
 20%|████████████████████████                                                                                                | 70/350 [00:57<02:15,  2.06it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.620578944683075, 'eval_accuracy': 0.78125, 'eval_recall': 0.7784313725490195, 'eval_runtime': 5.762, 'eval_samples_per_second': 11.107, 'eval_steps_per_second': 0.174, 'epoch': 10.0}
 22%|██████████████████████████▍                                                                                             | 77/350 [01:04<03:49,  1.19it/s]
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'eval_loss': 0.6100243926048279, 'eval_accuracy': 0.8125, 'eval_recall': 0.807843137254902, 'eval_runtime': 5.7349, 'eval_samples_per_second': 11.16, 'eval_steps_per_second': 0.174, 'epoch': 11.0}
{'train_runtime': 65.4451, 'train_samples_per_second': 333.104, 'train_steps_per_second': 5.348, 'train_loss': 0.6705044833096591, 'epoch': 11.0}
  warnings.warn('Was asked to gather along dimension 0, but all '
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:04<00:00,  4.79s/it]
Model Saved!
