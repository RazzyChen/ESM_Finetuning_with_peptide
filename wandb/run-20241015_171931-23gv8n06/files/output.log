Some weights of EsmForSequenceClassification were not initialized from the model checkpoint at facebook/esm2_t6_8M_UR50D and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 436/436 [00:00<00:00, 22306.05 examples/s]
Map: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:00<00:00, 11405.80 examples/s]
[2024-10-15 17:19:33,761] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m NVIDIA Inference is only supported on Ampere and newer architectures
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.1), only 1.0.0 is known to be compatible
[34m[1mwandb[0m: [33mWARNING[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
  0%|                                                                                                                                 | 0/200 [00:00<?, ?it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|██▍                                                                                                                      | 4/200 [00:04<00:46,  4.20it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6918668746948242, 'eval_accuracy': 0.5, 'eval_recall': 0.47058823529411764, 'eval_runtime': 3.7883, 'eval_samples_per_second': 16.894, 'eval_steps_per_second': 0.264, 'epoch': 1.0}
  4%|████▊                                                                                                                    | 8/200 [00:09<02:12,  1.45it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6903994083404541, 'eval_accuracy': 0.703125, 'eval_recall': 0.6911764705882353, 'eval_runtime': 3.4932, 'eval_samples_per_second': 18.321, 'eval_steps_per_second': 0.286, 'epoch': 2.0}
  6%|███████▏                                                                                                                | 12/200 [00:13<02:29,  1.26it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6881680488586426, 'eval_accuracy': 0.546875, 'eval_recall': 0.5735294117647058, 'eval_runtime': 3.7853, 'eval_samples_per_second': 16.907, 'eval_steps_per_second': 0.264, 'epoch': 3.0}
  8%|█████████▌                                                                                                              | 16/200 [00:18<02:39,  1.15it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6834682822227478, 'eval_accuracy': 0.703125, 'eval_recall': 0.7147058823529412, 'eval_runtime': 4.2626, 'eval_samples_per_second': 15.014, 'eval_steps_per_second': 0.235, 'epoch': 4.0}
 10%|████████████                                                                                                            | 20/200 [00:24<02:51,  1.05it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6783605217933655, 'eval_accuracy': 0.703125, 'eval_recall': 0.7205882352941176, 'eval_runtime': 4.7691, 'eval_samples_per_second': 13.42, 'eval_steps_per_second': 0.21, 'epoch': 5.0}
 12%|██████████████▍                                                                                                         | 24/200 [00:30<03:04,  1.05s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6716388463973999, 'eval_accuracy': 0.765625, 'eval_recall': 0.7735294117647059, 'eval_runtime': 5.9554, 'eval_samples_per_second': 10.747, 'eval_steps_per_second': 0.168, 'epoch': 6.0}
 14%|████████████████▊                                                                                                       | 28/200 [00:35<03:29,  1.22s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6657715439796448, 'eval_accuracy': 0.75, 'eval_recall': 0.7588235294117647, 'eval_runtime': 3.9565, 'eval_samples_per_second': 16.176, 'eval_steps_per_second': 0.253, 'epoch': 7.0}
 16%|███████████████████▏                                                                                                    | 32/200 [00:41<03:04,  1.10s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6590743064880371, 'eval_accuracy': 0.796875, 'eval_recall': 0.8009803921568628, 'eval_runtime': 5.1785, 'eval_samples_per_second': 12.359, 'eval_steps_per_second': 0.193, 'epoch': 8.0}
 18%|█████████████████████▌                                                                                                  | 36/200 [00:42<03:10,  1.16s/it]Using the latest cached version of the module from /home/zhaolab/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--recall/e40e6e98d18ff3f210f4d0b26fa721bfaa80704b1fdf890fa551cfabf94fc185 (last modified on Tue Oct 15 14:16:12 2024) since it couldn't be found locally at evaluate-metric--recall, or remotely on the Hugging Face Hub.
 18%|█████████████████████▌                                                                                                  | 36/200 [00:48<03:10,  1.16s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6531882882118225, 'eval_accuracy': 0.796875, 'eval_recall': 0.8009803921568628, 'eval_runtime': 6.2135, 'eval_samples_per_second': 10.3, 'eval_steps_per_second': 0.161, 'epoch': 9.0}
 20%|████████████████████████                                                                                                | 40/200 [00:54<03:28,  1.30s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6461839079856873, 'eval_accuracy': 0.78125, 'eval_recall': 0.7823529411764706, 'eval_runtime': 5.0262, 'eval_samples_per_second': 12.733, 'eval_steps_per_second': 0.199, 'epoch': 10.0}
 22%|██████████████████████████▍                                                                                             | 44/200 [00:58<03:14,  1.25s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6388688087463379, 'eval_accuracy': 0.75, 'eval_recall': 0.7490196078431373, 'eval_runtime': 3.9931, 'eval_samples_per_second': 16.028, 'eval_steps_per_second': 0.25, 'epoch': 11.0}
 24%|████████████████████████████▊                                                                                           | 48/200 [01:04<02:48,  1.11s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6316347122192383, 'eval_accuracy': 0.765625, 'eval_recall': 0.7637254901960784, 'eval_runtime': 5.3234, 'eval_samples_per_second': 12.022, 'eval_steps_per_second': 0.188, 'epoch': 12.0}
 26%|███████████████████████████████▏                                                                                        | 52/200 [01:10<02:54,  1.18s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.623805582523346, 'eval_accuracy': 0.8125, 'eval_recall': 0.807843137254902, 'eval_runtime': 4.5923, 'eval_samples_per_second': 13.936, 'eval_steps_per_second': 0.218, 'epoch': 13.0}
 28%|█████████████████████████████████▌                                                                                      | 56/200 [01:14<02:43,  1.14s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6166471838951111, 'eval_accuracy': 0.828125, 'eval_recall': 0.8225490196078431, 'eval_runtime': 4.1894, 'eval_samples_per_second': 15.277, 'eval_steps_per_second': 0.239, 'epoch': 14.0}
 30%|████████████████████████████████████                                                                                    | 60/200 [01:20<02:31,  1.08s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6097883582115173, 'eval_accuracy': 0.828125, 'eval_recall': 0.8205882352941176, 'eval_runtime': 5.253, 'eval_samples_per_second': 12.183, 'eval_steps_per_second': 0.19, 'epoch': 15.0}
 32%|██████████████████████████████████████▍                                                                                 | 64/200 [01:25<02:38,  1.17s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6039144992828369, 'eval_accuracy': 0.828125, 'eval_recall': 0.8225490196078431, 'eval_runtime': 3.8146, 'eval_samples_per_second': 16.778, 'eval_steps_per_second': 0.262, 'epoch': 16.0}
 34%|███████████████████████████████████                                                                    | 68/200 [01:30<02:18,  1.05s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.5986713767051697, 'eval_accuracy': 0.78125, 'eval_recall': 0.7784313725490195, 'eval_runtime': 4.0849, 'eval_samples_per_second': 15.667, 'eval_steps_per_second': 0.245, 'epoch': 17.0}
 36%|█████████████████████████████████████                                                                  | 72/200 [01:34<02:10,  1.02s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.5929248332977295, 'eval_accuracy': 0.765625, 'eval_recall': 0.7637254901960784, 'eval_runtime': 3.9917, 'eval_samples_per_second': 16.033, 'eval_steps_per_second': 0.251, 'epoch': 18.0}
 38%|███████████████████████████████████████▏                                                               | 76/200 [01:39<02:42,  1.31s/it]
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'eval_loss': 0.5867929458618164, 'eval_accuracy': 0.78125, 'eval_recall': 0.7784313725490195, 'eval_runtime': 3.6989, 'eval_samples_per_second': 17.303, 'eval_steps_per_second': 0.27, 'epoch': 19.0}
{'train_runtime': 100.1169, 'train_samples_per_second': 217.745, 'train_steps_per_second': 1.998, 'train_loss': 0.6586591820967825, 'epoch': 19.0}
  warnings.warn('Was asked to gather along dimension 0, but all '
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:03<00:00,  3.81s/it]
Model Saved!
