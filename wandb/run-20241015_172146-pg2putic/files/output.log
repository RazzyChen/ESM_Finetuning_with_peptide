Some weights of EsmForSequenceClassification were not initialized from the model checkpoint at facebook/esm2_t6_8M_UR50D and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|███████████████████████████████████████████████████████████████████████████████████████| 436/436 [00:00<00:00, 23187.35 examples/s]
Map: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:00<00:00, 11965.56 examples/s]
[2024-10-15 17:21:48,072] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m NVIDIA Inference is only supported on Ampere and newer architectures
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.1), only 1.0.0 is known to be compatible
[34m[1mwandb[0m: [33mWARNING[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
  0%|                                                                                                                | 0/100 [00:00<?, ?it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|██                                                                                                      | 2/100 [00:06<01:45,  1.08s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.6860094666481018, 'eval_accuracy': 0.734375, 'eval_recall': 0.7382352941176471, 'eval_runtime': 4.8596, 'eval_samples_per_second': 13.17, 'eval_steps_per_second': 0.206, 'epoch': 1.0}
  4%|████▏                                                                                                   | 4/100 [00:10<03:42,  2.32s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.6646463871002197, 'eval_accuracy': 0.75, 'eval_recall': 0.7627450980392156, 'eval_runtime': 4.1487, 'eval_samples_per_second': 15.427, 'eval_steps_per_second': 0.241, 'epoch': 2.0}
  6%|██████▏                                                                                                 | 6/100 [00:15<03:42,  2.37s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.6273956894874573, 'eval_accuracy': 0.78125, 'eval_recall': 0.7901960784313726, 'eval_runtime': 4.0457, 'eval_samples_per_second': 15.819, 'eval_steps_per_second': 0.247, 'epoch': 3.0}
  8%|████████▎                                                                                               | 8/100 [00:20<03:37,  2.36s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.5769844055175781, 'eval_accuracy': 0.765625, 'eval_recall': 0.75, 'eval_runtime': 4.1582, 'eval_samples_per_second': 15.391, 'eval_steps_per_second': 0.24, 'epoch': 4.0}
 10%|██████████▎                                                                                            | 10/100 [00:25<03:34,  2.39s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.5199509263038635, 'eval_accuracy': 0.8125, 'eval_recall': 0.807843137254902, 'eval_runtime': 4.2187, 'eval_samples_per_second': 15.17, 'eval_steps_per_second': 0.237, 'epoch': 5.0}
 12%|████████████▎                                                                                          | 12/100 [00:30<03:31,  2.40s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.46518394351005554, 'eval_accuracy': 0.84375, 'eval_recall': 0.8352941176470587, 'eval_runtime': 4.6968, 'eval_samples_per_second': 13.626, 'eval_steps_per_second': 0.213, 'epoch': 6.0}
 14%|██████████████▍                                                                                        | 14/100 [00:37<03:35,  2.51s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.42258647084236145, 'eval_accuracy': 0.84375, 'eval_recall': 0.8490196078431372, 'eval_runtime': 6.4405, 'eval_samples_per_second': 9.937, 'eval_steps_per_second': 0.155, 'epoch': 7.0}
 16%|████████████████▍                                                                                      | 16/100 [00:43<04:00,  2.87s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.3948557674884796, 'eval_accuracy': 0.84375, 'eval_recall': 0.8372549019607842, 'eval_runtime': 5.3195, 'eval_samples_per_second': 12.031, 'eval_steps_per_second': 0.188, 'epoch': 8.0}
 18%|██████████████████▌                                                                                    | 18/100 [00:48<04:00,  2.94s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.3697381615638733, 'eval_accuracy': 0.875, 'eval_recall': 0.8784313725490196, 'eval_runtime': 3.9978, 'eval_samples_per_second': 16.009, 'eval_steps_per_second': 0.25, 'epoch': 9.0}
 20%|████████████████████▌                                                                                  | 20/100 [00:53<03:39,  2.74s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.4426422715187073, 'eval_accuracy': 0.796875, 'eval_recall': 0.7872549019607843, 'eval_runtime': 3.6365, 'eval_samples_per_second': 17.599, 'eval_steps_per_second': 0.275, 'epoch': 10.0}
 22%|██████████████████████▋                                                                                | 22/100 [00:58<03:20,  2.57s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.4217841923236847, 'eval_accuracy': 0.875, 'eval_recall': 0.8784313725490196, 'eval_runtime': 4.9345, 'eval_samples_per_second': 12.97, 'eval_steps_per_second': 0.203, 'epoch': 11.0}
 24%|████████████████████████▋                                                                              | 24/100 [01:06<03:20,  2.64s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.42596837878227234, 'eval_accuracy': 0.828125, 'eval_recall': 0.8245098039215686, 'eval_runtime': 6.791, 'eval_samples_per_second': 9.424, 'eval_steps_per_second': 0.147, 'epoch': 12.0}
 26%|██████████████████████████▊                                                                            | 26/100 [01:11<03:40,  2.98s/it]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                            
{'eval_loss': 0.470469206571579, 'eval_accuracy': 0.796875, 'eval_recall': 0.8049019607843138, 'eval_runtime': 4.3775, 'eval_samples_per_second': 14.62, 'eval_steps_per_second': 0.228, 'epoch': 13.0}
 28%|████████████████████████████▊                                                                          | 28/100 [01:16<03:17,  2.74s/it]
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'eval_loss': 0.5264253616333008, 'eval_accuracy': 0.75, 'eval_recall': 0.7372549019607844, 'eval_runtime': 4.6226, 'eval_samples_per_second': 13.845, 'eval_steps_per_second': 0.216, 'epoch': 14.0}
{'train_runtime': 77.3252, 'train_samples_per_second': 281.926, 'train_steps_per_second': 1.293, 'train_loss': 0.5538609368460519, 'epoch': 14.0}
  warnings.warn('Was asked to gather along dimension 0, but all '
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:03<00:00,  3.71s/it]
Model Saved!
