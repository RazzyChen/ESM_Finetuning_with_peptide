Some weights of EsmForSequenceClassification were not initialized from the model checkpoint at facebook/esm2_t6_8M_UR50D and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 436/436 [00:00<00:00, 21149.06 examples/s]
Map: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:00<00:00, 11152.28 examples/s]
[2024-10-15 17:04:10,378] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m NVIDIA Inference is only supported on Ampere and newer architectures
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.1), only 1.0.0 is known to be compatible
[34m[1mwandb[0m: [33mWARNING[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
  0%|                                                                                                                                 | 0/350 [00:00<?, ?it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  2%|██▍                                                                                                                      | 7/350 [00:05<00:44,  7.71it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6895813941955566, 'eval_accuracy': 0.484375, 'eval_recall': 0.5147058823529411, 'eval_runtime': 4.5881, 'eval_samples_per_second': 13.949, 'eval_steps_per_second': 0.218, 'epoch': 1.0}
  4%|████▊                                                                                                                   | 14/350 [00:11<02:40,  2.09it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6656402945518494, 'eval_accuracy': 0.734375, 'eval_recall': 0.746078431372549, 'eval_runtime': 4.6186, 'eval_samples_per_second': 13.857, 'eval_steps_per_second': 0.217, 'epoch': 2.0}
  6%|███████▏                                                                                                                | 21/350 [00:17<03:19,  1.65it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.6165779232978821, 'eval_accuracy': 0.828125, 'eval_recall': 0.8225490196078431, 'eval_runtime': 5.3478, 'eval_samples_per_second': 11.967, 'eval_steps_per_second': 0.187, 'epoch': 3.0}
  8%|█████████▌                                                                                                              | 28/350 [00:22<02:58,  1.81it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.5623450875282288, 'eval_accuracy': 0.8125, 'eval_recall': 0.807843137254902, 'eval_runtime': 3.9302, 'eval_samples_per_second': 16.284, 'eval_steps_per_second': 0.254, 'epoch': 4.0}
 10%|████████████                                                                                                            | 35/350 [00:28<03:05,  1.70it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.51043701171875, 'eval_accuracy': 0.84375, 'eval_recall': 0.8372549019607842, 'eval_runtime': 4.8453, 'eval_samples_per_second': 13.209, 'eval_steps_per_second': 0.206, 'epoch': 5.0}
 12%|██████████████▍                                                                                                         | 42/350 [00:35<02:45,  1.86it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.484771192073822, 'eval_accuracy': 0.75, 'eval_recall': 0.7607843137254902, 'eval_runtime': 6.3257, 'eval_samples_per_second': 10.117, 'eval_steps_per_second': 0.158, 'epoch': 6.0}
 14%|████████████████▊                                                                                                       | 49/350 [00:40<03:46,  1.33it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.47049689292907715, 'eval_accuracy': 0.78125, 'eval_recall': 0.7666666666666666, 'eval_runtime': 4.462, 'eval_samples_per_second': 14.343, 'eval_steps_per_second': 0.224, 'epoch': 7.0}
 16%|███████████████████▏                                                                                                    | 56/350 [00:46<02:48,  1.74it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.5099442005157471, 'eval_accuracy': 0.734375, 'eval_recall': 0.746078431372549, 'eval_runtime': 4.6589, 'eval_samples_per_second': 13.737, 'eval_steps_per_second': 0.215, 'epoch': 8.0}
 18%|█████████████████████▌                                                                                                  | 63/350 [00:52<03:06,  1.54it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '                                                                                             
{'eval_loss': 0.4727952182292938, 'eval_accuracy': 0.75, 'eval_recall': 0.7372549019607844, 'eval_runtime': 5.8874, 'eval_samples_per_second': 10.871, 'eval_steps_per_second': 0.17, 'epoch': 9.0}
 20%|████████████████████████                                                                                                | 70/350 [00:59<03:58,  1.17it/s]
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'eval_loss': 0.4305773377418518, 'eval_accuracy': 0.8125, 'eval_recall': 0.8196078431372549, 'eval_runtime': 5.921, 'eval_samples_per_second': 10.809, 'eval_steps_per_second': 0.169, 'epoch': 10.0}
{'train_runtime': 60.2915, 'train_samples_per_second': 361.577, 'train_steps_per_second': 5.805, 'train_loss': 0.5877704620361328, 'epoch': 10.0}
  warnings.warn('Was asked to gather along dimension 0, but all '
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:04<00:00,  4.73s/it]
Model Saved!
