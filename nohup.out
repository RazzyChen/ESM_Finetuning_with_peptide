wandb: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: yangzichen (yangzichen-zhaolab). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.18.3
wandb: Run data is saved locally in /home/zhaolab/Documents/YZC_SSD/ESM_LoRA/wandb/run-20241015_165836-u856mq0a
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run jumping-pine-21
wandb: ‚≠êÔ∏è View project at https://wandb.ai/yangzichen-zhaolab/ESM2_8M_FT_with_peptide
wandb: üöÄ View run at https://wandb.ai/yangzichen-zhaolab/ESM2_8M_FT_with_peptide/runs/u856mq0a
Some weights of EsmForSequenceClassification were not initialized from the model checkpoint at facebook/esm2_t6_8M_UR50D and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map:   0%|          | 0/436 [00:00<?, ? examples/s]Map: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 436/436 [00:00<00:00, 18800.80 examples/s]
Map:   0%|          | 0/64 [00:00<?, ? examples/s]Map: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 64/64 [00:00<00:00, 11486.33 examples/s]
[2024-10-15 16:58:42,027] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
wandb: WARNING The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m NVIDIA Inference is only supported on Ampere and newer architectures
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.1), only 1.0.0 is known to be compatible
  0%|          | 0/350 [00:00<?, ?it/s]/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  0%|          | 1/350 [00:01<06:11,  1.06s/it]  1%|          | 4/350 [00:01<01:19,  4.36it/s]  2%|‚ñè         | 7/350 [00:01<00:44,  7.72it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A                                               
                                     [A  2%|‚ñè         | 7/350 [00:05<00:44,  7.72it/s]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:04<00:00,  4.04s/it][A
                                             [A{'eval_loss': 0.6849947571754456, 'eval_accuracy': 0.75, 'eval_recall': 0.7411764705882353, 'eval_runtime': 4.5473, 'eval_samples_per_second': 14.074, 'eval_steps_per_second': 0.22, 'epoch': 1.0}
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  3%|‚ñé         | 9/350 [00:06<05:27,  1.04it/s]  3%|‚ñé         | 12/350 [00:06<03:13,  1.75it/s]  4%|‚ñç         | 14/350 [00:06<02:22,  2.36it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A                                                
                                     [A  4%|‚ñç         | 14/350 [00:11<02:22,  2.36it/s]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:04<00:00,  4.37s/it][A
                                             [A{'eval_loss': 0.662964403629303, 'eval_accuracy': 0.671875, 'eval_recall': 0.6892156862745098, 'eval_runtime': 4.9016, 'eval_samples_per_second': 13.057, 'eval_steps_per_second': 0.204, 'epoch': 2.0}
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  5%|‚ñç         | 16/350 [00:12<06:09,  1.11s/it]  5%|‚ñå         | 19/350 [00:12<03:50,  1.44it/s]  6%|‚ñå         | 21/350 [00:12<02:52,  1.91it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A                                                
                                     [A  6%|‚ñå         | 21/350 [00:17<02:52,  1.91it/s]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:04<00:00,  4.10s/it][A
                                             [A{'eval_loss': 0.6106813549995422, 'eval_accuracy': 0.828125, 'eval_recall': 0.8186274509803921, 'eval_runtime': 4.6397, 'eval_samples_per_second': 13.794, 'eval_steps_per_second': 0.216, 'epoch': 3.0}
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  7%|‚ñã         | 23/350 [00:17<06:01,  1.11s/it]  8%|‚ñä         | 27/350 [00:17<03:24,  1.58it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A                                                
                                     [A  8%|‚ñä         | 28/350 [00:23<03:23,  1.58it/s]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:04<00:00,  4.80s/it][A
                                             [A{'eval_loss': 0.55599445104599, 'eval_accuracy': 0.8125, 'eval_recall': 0.807843137254902, 'eval_runtime': 5.4056, 'eval_samples_per_second': 11.839, 'eval_steps_per_second': 0.185, 'epoch': 4.0}
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  8%|‚ñä         | 29/350 [00:23<06:28,  1.21s/it]  9%|‚ñâ         | 32/350 [00:24<04:18,  1.23it/s] 10%|‚ñà         | 35/350 [00:24<02:57,  1.78it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A                                                
                                     [A 10%|‚ñà         | 35/350 [00:27<02:57,  1.78it/s]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:03<00:00,  3.12s/it][A
                                             [A{'eval_loss': 0.5048022866249084, 'eval_accuracy': 0.828125, 'eval_recall': 0.8225490196078431, 'eval_runtime': 3.6576, 'eval_samples_per_second': 17.498, 'eval_steps_per_second': 0.273, 'epoch': 5.0}
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
 11%|‚ñà         | 37/350 [00:28<04:53,  1.07it/s] 12%|‚ñà‚ñè        | 41/350 [00:28<02:56,  1.75it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A                                                
                                     [A 12%|‚ñà‚ñè        | 42/350 [00:34<02:55,  1.75it/s]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:05<00:00,  5.77s/it][A
                                             [A{'eval_loss': 0.4763510227203369, 'eval_accuracy': 0.78125, 'eval_recall': 0.7901960784313726, 'eval_runtime': 6.3051, 'eval_samples_per_second': 10.151, 'eval_steps_per_second': 0.159, 'epoch': 6.0}
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
 12%|‚ñà‚ñè        | 43/350 [00:35<06:15,  1.22s/it] 13%|‚ñà‚ñé        | 47/350 [00:35<03:49,  1.32it/s] 14%|‚ñà‚ñç        | 49/350 [00:35<03:02,  1.65it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A                                                
                                     [A 14%|‚ñà‚ñç        | 49/350 [00:42<03:02,  1.65it/s]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:06<00:00,  6.13s/it][A
                                             [A{'eval_loss': 0.4628302752971649, 'eval_accuracy': 0.78125, 'eval_recall': 0.7666666666666666, 'eval_runtime': 6.6576, 'eval_samples_per_second': 9.613, 'eval_steps_per_second': 0.15, 'epoch': 7.0}
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
 15%|‚ñà‚ñç        | 51/350 [00:43<06:36,  1.33s/it] 16%|‚ñà‚ñå        | 55/350 [00:43<03:57,  1.24it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A                                                
                                     [A 16%|‚ñà‚ñå        | 56/350 [00:49<03:56,  1.24it/s]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:05<00:00,  5.43s/it][A
                                             [A                                                 16%|‚ñà‚ñå        | 56/350 [00:49<03:56,  1.24it/s] 16%|‚ñà‚ñå        | 56/350 [00:49<04:19,  1.13it/s]
{'eval_loss': 0.5004042983055115, 'eval_accuracy': 0.734375, 'eval_recall': 0.746078431372549, 'eval_runtime': 5.968, 'eval_samples_per_second': 10.724, 'eval_steps_per_second': 0.168, 'epoch': 8.0}
{'train_runtime': 49.9988, 'train_samples_per_second': 436.011, 'train_steps_per_second': 7.0, 'train_loss': 0.6070337976728167, 'epoch': 8.0}
/home/zhaolab/Software/MiniConda/envs/esm/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  0%|          | 0/1 [00:00<?, ?it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:02<00:00,  2.95s/it]
Model Saved!
[1;34mwandb[0m: üöÄ View run [33mjumping-pine-21[0m at: [34mhttps://wandb.ai/yangzichen-zhaolab/ESM2_8M_FT_with_peptide/runs/u856mq0a[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20241015_165836-u856mq0a/logs[0m
